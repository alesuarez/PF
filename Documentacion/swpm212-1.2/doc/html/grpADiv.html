<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SWPM AT86RF212: Antenna Diversity</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="main.html">AT86RF212 Programming</a>&nbsp;&raquo&nbsp;<a class="el" href="pgSwpmAT86RF212.html">Software Programming Model</a>&nbsp;&raquo&nbsp;<a class="el" href="grpMisc.html">Extended Features</a>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="grpADiv">Antenna Diversity </a></h1>This section describes the configuration and usage of the <em>MAC based Antenna Diversity</em> (AD) feature.<p>
Antenna diversity uses two antennas to select the most reliable RF signal path. This may lead to an improved robustness of the entire network connection, because impacts of multipath propagation and fading can be reduced.<p>
<a class="anchor" name="parm_extswen"></a> <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>extswen</em>&nbsp;</td><td>control of external RF switch using differential pin pair DIG1/DIG2: {0} output pins DIG1 and DIG2 are pulled-down to digital ground, {1} output pins DIG1 and DIG2 are enabled thus providing a differential control signal for a RF switch. <a class="anchor" name="parm_antctrl"></a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>antctrl</em>&nbsp;</td><td>antenna selection; {1} select antenna 0 (DIG1=L, DIG2=H), {2} select antenna 1 (DIG1=H, DIG2=L), {0,3} reserved.</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd><br>
<small><b>&gt;&gt;</b></small>&nbsp; In order to reduce the power consumption in the states <a class="el" href="grpIntroStates.html#stTrxOff">TRX_OFF</a> or <a class="el" href="grpIntroStates.html#stSleep">SLEEP</a>, the RF switch control shall be disabled (<a class="el" href="grpADiv.html#parm_extswen">extswen</a>=0). <br>
<small><b>&gt;&gt;</b></small>&nbsp; If <a class="el" href="grpRxtime.html">RX Frame Time Stamping</a> is used in combination with the antenna diversity feature, the pin DIG1 controls the RF switch and the pin DIG2 is used for RX frame time stamping. In this case, the radio transceiver does not provide a differential RF switch control signal. <br>
<small><b>&gt;&gt;</b></small>&nbsp; If RF switch control is disabled (<a class="el" href="grpADiv.html#parm_extswen">extswen</a>=0), the sub register <a class="el" href="group__apiHalPHY212Sreg.html#g8bbf7de86acb786998c05dfce72100ec">SR_ANT_CTRL</a> shall be set to its default value <a class="el" href="grpADiv.html#parm_antctrl">antctrl</a>=1.</dd></dl>
<b>Use Cases:</b><ul>
<li><a class="el" href="grpADiv.html#secad_set_antenna">SET_ANTENNA</a></li><li><a class="el" href="grpADiv.html#secad_get_antenna">GET_ANTENNA</a></li></ul>
<p>
<hr>
<h2><a class="anchor" name="secad_set_antenna">
SET_ANTENNA</a></h2>
An antenna can be selected by enabling the RF switch control <a class="el" href="grpADiv.html#parm_extswen">extswen</a>=1 and configuring <a class="el" href="grpADiv.html#parm_antctrl">antctrl</a>.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Setting an antenna takes effect immediately and thus may disturb an ongoing transmit or receive transaction. Therefore, setting the antenna should not be carried out in any of the <a class="el" href="grpIntroStates.html#stTrxBusy">[BUSY]</a> states.</dd></dl>
<div align="center">
<img src="inline_mscgraph_100.png" alt="inline_mscgraph_100" border="0" usemap="#inline_mscgraph_100.map">
<map name="inline_mscgraph_100.map"><area href="grpIntroStates.html#stTrxConfig" shape="rect" coords="427,26,473,39" alt="">
</map>
</div>
 <dl class="user" compact><dt><b>Code example</b></dt><dd><div class="fragment"><pre class="fragment">    <span class="comment">/* AT86RF212::[CONFIG] */</span>
    <a class="code" href="group__apiHalFuncBasic.html#g4a22a30602ea72effde4450ce80a6480" title="Write a value to a subregister.">trx_bit_write</a>(<a class="code" href="group__apiHalPHY212Sreg.html#g8bbf7de86acb786998c05dfce72100ec">SR_ANT_CTRL</a>, antctrl);
    <a class="code" href="group__apiHalFuncBasic.html#g4a22a30602ea72effde4450ce80a6480" title="Write a value to a subregister.">trx_bit_write</a>(<a class="code" href="group__apiHalPHY212Sreg.html#g05811ed876f3562f868c318d790babde">SR_ANT_EXT_SW_EN</a>, 1);
</pre></div></dd></dl>
<h2><a class="anchor" name="secad_get_antenna">
GET_ANTENNA</a></h2>
The current selected antenna (see <a class="el" href="grpADiv.html#parm_antctrl">antctrl</a>) can be read from sub register <a class="el" href="group__apiHalPHY212Sreg.html#g8bbf7de86acb786998c05dfce72100ec">SR_ANT_CTRL</a> whenever the radio transceiver is in one of the <a class="el" href="grpIntroStates.html#stTrxActive">[ACTIVE]</a> states.<p>
<div align="center">
<img src="inline_mscgraph_101.png" alt="inline_mscgraph_101" border="0" usemap="#inline_mscgraph_101.map">
<map name="inline_mscgraph_101.map"><area href="grpIntroStates.html#stTrxActive" shape="rect" coords="427,26,473,39" alt="">
</map>
</div>
 <dl class="user" compact><dt><b>Code example</b></dt><dd><div class="fragment"><pre class="fragment">    <span class="comment">/* AT86RF212::[ACTIVE] */</span>
    antctrl = <a class="code" href="group__apiHalFuncBasic.html#ge7ea3d090b5d26b73a5c62e2e61e0231" title="Read a value from a subregister.">trx_bit_read</a>(<a class="code" href="group__apiHalPHY212Sreg.html#g8bbf7de86acb786998c05dfce72100ec">SR_ANT_CTRL</a>);
    proc_antenna(antenna);
</pre></div> </dd></dl>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 17 13:35:02 2009 for SWPM AT86RF212 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
