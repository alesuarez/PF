<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SWPM AT86RF212: Buffer Underrun Interrupt</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="main.html">AT86RF212 Programming</a>&nbsp;&raquo&nbsp;<a class="el" href="pgSwpmAT86RF212.html">Software Programming Model</a>&nbsp;&raquo&nbsp;<a class="el" href="grpHandleIrq.html">Interrupts</a>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="grpIrqUR">Buffer Underrun Interrupt </a></h1><ul>
<li><a class="el" href="grpIrqUR.html#secphy_event_fifounderrun_tx">PHY_EVENT_TRX_UR_TX</a></li><li><a class="el" href="grpIrqUR.html#secphy_event_fifounderrun_rx">PHY_EVENT_TRX_UR_RX</a></li></ul>
<p>
<hr>
<h2><a class="anchor" name="secphy_event_fifounderrun_tx">
PHY_EVENT_TRX_UR_TX</a></h2>
If the interrupt <a class="el" href="group__apiHalPHY212Const.html#gdfe439356d965b05adfe5d3a206e249b">TRX_IRQ_TRX_UR</a> occurs during a frame transmission, it indicates a frame buffer write access violation. This may happen when a frame buffer write process is started after the transmission was initiated (see <a class="el" href="grpPhyTx.html#secphy_data_request_pinstart">PHY_DATA_REQUEST_PINSTART</a>, <a class="el" href="grpPhyTx.html#secphy_data_request_regstart">PHY_DATA_REQUEST_REGSTART</a>, <a class="el" href="grpRf212AutoTx.html#secphy_data_request_autotx_aret">PHY_DATA_REQUEST_TX_ARET</a>) and the <a class="el" href="grpIntroMCU.html#wireSPI">SPI</a> transfer speed is lower than the on-air data rate of the radio transceiver. In this case, the frame buffer read pointer moves beyond the frame buffer write pointer, which is controlled by the <a class="el" href="group__apiHalFuncBasic.html#g9191fea0f277cb46af5ad28b67a6356d">trx_frame_write</a> function. If an <a class="el" href="group__apiHalPHY212Const.html#gdfe439356d965b05adfe5d3a206e249b">TRX_IRQ_TRX_UR</a> occured, the entire transmit transaction has to be repeated because the transmit data are invalid. If the SPI data rate of the system is generally lower then the on-air data rate of the radio transceiver, the entire frame has to be downloaded before the transmission is initiated.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Even if an <a class="el" href="group__apiHalPHY212Const.html#gdfe439356d965b05adfe5d3a206e249b">TRX_IRQ_TRX_UR</a> occurs during transmission, an <a class="el" href="group__apiHalPHY212Const.html#ge34c1f5817526945d96c7cda6689f342">TRX_IRQ_TRX_END</a> will be generated. The radio will transmit the actual contents of the frame buffer.</dd></dl>
<div align="center">
<img src="inline_mscgraph_66.png" alt="inline_mscgraph_66" border="0" usemap="#inline_mscgraph_66.map">
<map name="inline_mscgraph_66.map"><area href="grpIntroStates.html#stTrxTXBusy" shape="rect" coords="424,26,476,39" alt="">
</map>
</div>
 <dl class="user" compact><dt><b>Code example</b></dt><dd><div class="fragment"><pre class="fragment">    <span class="comment">/* AT86RF212::[TX_BUSY] */</span>
    <a class="code" href="group__apiHalFuncBasic.html#g9191fea0f277cb46af5ad28b67a6356d" title="Write a frame to the radio transceiver.">trx_frame_write</a>(len(frm), frm);
    <span class="comment">/* TRX_IRQ_TRX_UR occurs here */</span>
    <span class="comment">/* MCU::ISR */</span>
    cause = <a class="code" href="group__apiHalFuncBasic.html#gd31a9a2f63e52d485d975d59f7c1d5f4" title="Read the value from a register.">trx_reg_read</a>(<a class="code" href="group__apiHalPHY212Reg.html#g7dec4b1e3d3bfd3e9f6c243abc4f008e">RG_IRQ_STATUS</a>);
    <span class="comment">/* MCU::ISR_TXUR */</span>
</pre></div></dd></dl>
<h2><a class="anchor" name="secphy_event_fifounderrun_rx">
PHY_EVENT_TRX_UR_RX</a></h2>
If the interrupt <a class="el" href="group__apiHalPHY212Const.html#gdfe439356d965b05adfe5d3a206e249b">TRX_IRQ_TRX_UR</a> occurs during a frame reception, it indicates a frame buffer read access violation. This may happen during a frame buffer read access if:<ul>
<li>the SPI data rate is higher than the on-air data rate, or</li><li>the computed wait time <a class="el" href="grpPhyRx.html#twait">twait</a> was too short. In this case, the SPI read pointer, which is controlled by the <a class="el" href="group__apiHalFuncBasic.html#g88ff4f45a0c4c7435d686150cc7fb4c2">trx_frame_read</a> function, moves beyond the SPI write pointer and the data read from the frame buffer are invalid. The receive transaction is not affected by this interrupt and the frame can be uploaded again.</li></ul>
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>RX underrun interrupts can be avoided, if the <a class="el" href="grpBEmpty.html">frame buffer empty indicator</a> is used.</dd></dl>
<div align="center">
<img src="inline_mscgraph_67.png" alt="inline_mscgraph_67" border="0" usemap="#inline_mscgraph_67.map">
<map name="inline_mscgraph_67.map"><area href="grpIntroStates.html#stTrxRXBusy" shape="rect" coords="424,26,476,39" alt="">
</map>
</div>
 <dl class="user" compact><dt><b>Code example</b></dt><dd><div class="fragment"><pre class="fragment">    <span class="comment">/* AT86RF212::[RX_BUSY] */</span>
    frm = <a class="code" href="group__apiHalFuncBasic.html#g88ff4f45a0c4c7435d686150cc7fb4c2" title="Read a frame from the radio transceiver.">trx_frame_read</a>();
    <span class="comment">/* TRX_IRQ_TRX_UR occurs here */</span>
    <span class="comment">/* MCU::ISR */</span>
    cause = <a class="code" href="group__apiHalFuncBasic.html#gd31a9a2f63e52d485d975d59f7c1d5f4" title="Read the value from a register.">trx_reg_read</a>(<a class="code" href="group__apiHalPHY212Reg.html#g7dec4b1e3d3bfd3e9f6c243abc4f008e">RG_IRQ_STATUS</a>);
    <span class="comment">/* MCU::ISR_RXUR */</span>
</pre></div> </dd></dl>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 17 13:35:00 2009 for SWPM AT86RF212 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
