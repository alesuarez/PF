<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SWPM AT86RF212: PLL Handling</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="main.html">AT86RF212 Programming</a>&nbsp;&raquo&nbsp;<a class="el" href="pgSwpmAT86RF212.html">Software Programming Model</a>&nbsp;&raquo&nbsp;<a class="el" href="grpCfg.html">Radio Transceiver Configuration</a>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="grpRf212Pll">PLL Handling </a></h1>This section describes, how PLL events are handled and how the PLL status is retrieved. A locked PLL is mandatory for any receive or transmit operation. Locking and unlocking of the PLL are signaled with the interrupts <a class="el" href="group__apiHalPHY212Const.html#g3a84434fef569c52df0df298c308e624">TRX_IRQ_PLL_LOCK</a> and <a class="el" href="group__apiHalPHY212Const.html#gc78ca3c5bcfc8977504c7b567d99af7d">TRX_IRQ_PLL_UNLOCK</a>. For a more detailed decription on PLL locking/unlocking conditions refer to <a class="el" href="pgRef.html#refDataSheet">section 7.8.5</a> <em>(Interrupt Handling)</em> of the AT86RF212 datasheet.<p>
The PLL status can be read from the sub register <a class="el" href="group__apiHalPHY212Sreg.html#g44f5022cdff22bfa68c153f28e149532">SR_PLL_LOCK_CP</a> with the sequence <a class="el" href="grpRf212Pll.html#secget_pll_status">GET_PLL_STATUS</a>. The unlocking of the PLL is a critical event, if it occurs during the reception or transmission of a frame (see <a class="el" href="grpRf212Pll.html#secphy_pllunlock">PHY_UNLOCK_PLL</a>). Generally, a test of the PLL locking can be done with a state transition from <a class="el" href="grpIntroStates.html#stTrxOff">TRX_OFF</a> to <a class="el" href="grpIntroStates.html#stPllOn">PLL_ON</a> (see <a class="el" href="grpStateTxOn.html#secplme_set_trx_state_txon_at_trxoff">PHY_STATE_TRX_OFF__PLL_ON</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pllstat</em>&nbsp;</td><td>This parameter has the value 1, if the PLL is locked to the programmed center frequency (see <a class="el" href="grpSetChanFreq.html">RF Channel Selection</a>), otherwise it is 0.</td></tr>
  </table>
</dl>
<b>Use Cases:</b><ul>
<li><a class="el" href="grpRf212Pll.html#secget_pll_status">GET_PLL_STATUS</a></li><li><a class="el" href="grpRf212Pll.html#secphy_pllunlock">PHY_UNLOCK_PLL</a></li></ul>
<p>
<hr>
<h2><a class="anchor" name="secget_pll_status">
GET_PLL_STATUS</a></h2>
<div align="center">
<img src="inline_mscgraph_29.png" alt="inline_mscgraph_29" border="0" usemap="#inline_mscgraph_29.map">
<map name="inline_mscgraph_29.map"><area href="grpIntroStates.html#stTrxActive" shape="rect" coords="427,26,473,39" alt="">
</map>
</div>
 <dl class="user" compact><dt><b>Code example</b></dt><dd><div class="fragment"><pre class="fragment">    <span class="comment">/* AT86RF212::[ACTIVE] */</span>
    pllstat = <a class="code" href="group__apiHalFuncBasic.html#ge7ea3d090b5d26b73a5c62e2e61e0231" title="Read a value from a subregister.">trx_bit_read</a>(<a class="code" href="group__apiHalPHY212Sreg.html#g44f5022cdff22bfa68c153f28e149532">SR_PLL_LOCK_CP</a>);
</pre></div></dd></dl>
<h2><a class="anchor" name="secphy_pllunlock">
PHY_UNLOCK_PLL</a></h2>
If the <a class="el" href="group__apiHalPHY212Const.html#gc78ca3c5bcfc8977504c7b567d99af7d">TRX_IRQ_PLL_UNLOCK</a> interrupt occurs during a frame transmission or reception, this transaction has failed. The higher software layers should handle this error the same way like a normal transmission error. As long as the PLL is unlocked (see also <a class="el" href="grpRf212Pll.html#secget_pll_status">GET_PLL_STATUS</a>), no transmission and reception of frames is possible.<p>
The unlocking of the PLL is a critical error, if it occurs in one of the <a class="el" href="grpIntroStates.html#stPllActive">[PLL_ACTIVE]</a> states and no <a class="el" href="group__apiHalPHY212Const.html#g3a84434fef569c52df0df298c308e624">TRX_IRQ_PLL_LOCK</a> interrupt follows after a <a class="el" href="group__apiHalPHY212Const.html#gc78ca3c5bcfc8977504c7b567d99af7d">TRX_IRQ_PLL_UNLOCK</a> interrupt within the time <a class="el" href="pgConst.html#tLockCrit">tLockCrit</a>.<p>
In this case, the software should try to execute the sequence <a class="el" href="grpStateTxOn.html#secplme_set_trx_state_txon_at_trxoff">PHY_STATE_TRX_OFF__PLL_ON</a> in order to force the PLL to lock.<p>
<div align="center">
<img src="inline_mscgraph_30.png" alt="inline_mscgraph_30" border="0" usemap="#inline_mscgraph_30.map">
<map name="inline_mscgraph_30.map"><area href="grpIntroStates.html#stPllActive" shape="rect" coords="415,26,485,39" alt="">
</map>
</div>
 <dl class="user" compact><dt><b>Code example</b></dt><dd><div class="fragment"><pre class="fragment">    <span class="comment">/* AT86RF212::[PLL_ACTIVE] */</span>
    <span class="comment">/* TRX_IRQ_PLL_UNLOCK occurs here */</span>
    handle_unlock();
</pre></div> </dd></dl>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 17 13:34:59 2009 for SWPM AT86RF212 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
