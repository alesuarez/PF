<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SWPM AT86RF212: CLKM Frequency Change</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="main.html">AT86RF212 Programming</a>&nbsp;&raquo&nbsp;<a class="el" href="pgSwpmAT86RF212.html">Software Programming Model</a>&nbsp;&raquo&nbsp;<a class="el" href="grpCfg.html">Radio Transceiver Configuration</a>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="grpRf212Clkm">CLKM Frequency Change </a></h1>This section describes, how the frequency of the CLKM signal is controlled. The CLKM signal is available at pin <a class="el" href="grpIntroMCU.html#wirePinClkm">TRX_PIN_CLKM</a> in all states except <a class="el" href="grpIntroStates.html#stSleep">SLEEP</a>, <a class="el" href="grpIntroStates.html#stRxOnNoClk">RX_ON_NOCLK</a>, <a class="el" href="grpIntroStates.html#stRxAackOn">RX_AACK_ON_NOCLK</a>, <a class="el" href="grpIntroStates.html#stRxAackBusyNoClk">BUSY_RX_AACK_NOCLK</a>. The frequency of the CLKM signal can be modified in two ways:<ul>
<li>The sequence <a class="el" href="grpRf212Clkm.html#secphy_change_clock">PHY_CHANGE_CLKM_FAST</a> can be used, if a clock change can happen on-the-fly, e.g. if a GPIO or a timer input is driven.</li><li>If the CLKM signal is used as clock source for the MCU (clkrate={1,...,5}) and therefore no on the fly frequency change is allowed, the sequence <a class="el" href="grpRf212Clkm.html#secphy_change_clock_safe">PHY_CHANGE_CLKM_SAFE</a> is used doing a clock change using a wake-sleep-wake transition.</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clkrate</em>&nbsp;</td><td>This parameter represents the frequency value of the CLKM signal, which is generated at pin <a class="el" href="grpIntroMCU.html#wirePinClkm">TRX_PIN_CLKM</a> (see table below).</td></tr>
  </table>
</dl>
<h2><a class="anchor" name="secClkmVal">
CLKM Frequencies</a></h2>
<table border="1" cellspacing="3" cellpadding="3">
<tr>
<th><em>clkrate</em> </th><th>f<sub>CLKM</sub> </th></tr>
<tr>
<td>0 </td><td>OFF, <a class="el" href="grpIntroMCU.html#wirePinClkm">CLKM = LOW</a>. </td></tr>
<tr>
<td>1 </td><td>1 MHz </td></tr>
<tr>
<td>2 </td><td>2 MHz </td></tr>
<tr>
<td>3 </td><td>4 MHz </td></tr>
<tr>
<td>4 </td><td>8 MHz </td></tr>
<tr>
<td>5 </td><td>16 MHz </td></tr>
<tr>
<td>6 </td><td>1/4 MHz=250 kHz </td></tr>
<tr>
<td>7 </td><td>IEEE 802.15.4 symbol rate<ul>
<li>BPSK_20 : 20 kHz</li><li>BPSK_40 : 40 kHz</li><li>O-QPSK_{100,200,400} : 25 kHz</li><li>O-QPSK_{250,500,1000} : 62.5 kHz </li></ul>
</td></tr>
</table>
<p>
<b>Use Cases:</b><ul>
<li><a class="el" href="grpRf212Clkm.html#secphy_change_clock">PHY_CHANGE_CLKM_FAST</a></li><li><a class="el" href="grpRf212Clkm.html#secphy_change_clock_safe">PHY_CHANGE_CLKM_SAFE</a></li></ul>
<p>
<hr>
<h2><a class="anchor" name="secphy_change_clock">
PHY_CHANGE_CLKM_FAST</a></h2>
With this sequence, the clock signal at <a class="el" href="grpIntroMCU.html#wirePinClkm">TRX_PIN_CLKM</a> is changed immediately.<p>
<div align="center">
<img src="inline_mscgraph_22.png" alt="inline_mscgraph_22" border="0" usemap="#inline_mscgraph_22.map">
<map name="inline_mscgraph_22.map"><area href="grpIntroStates.html#stTrxActive" shape="rect" coords="427,26,473,39" alt="">
</map>
</div>
 <dl class="user" compact><dt><b>Code example</b></dt><dd><div class="fragment"><pre class="fragment">    <span class="comment">/* AT86RF212::[ACTIVE] */</span>
    <a class="code" href="group__apiHalFuncBasic.html#g4a22a30602ea72effde4450ce80a6480" title="Write a value to a subregister.">trx_bit_write</a>(<a class="code" href="group__apiHalPHY212Sreg.html#g3517409068f4c36eedae73ed8ffead13">SR_CLKM_SHA_SEL</a>, 0);
    <a class="code" href="group__apiHalFuncBasic.html#g4a22a30602ea72effde4450ce80a6480" title="Write a value to a subregister.">trx_bit_write</a>(<a class="code" href="group__apiHalPHY212Sreg.html#gc108f260911d536daba845f79a0c7eff">SR_CLKM_CTRL</a>, clkrate);
</pre></div></dd></dl>
<h2><a class="anchor" name="secphy_change_clock_safe">
PHY_CHANGE_CLKM_SAFE</a></h2>
With this sequence, the clock signal at <a class="el" href="grpIntroMCU.html#wirePinClkm">TRX_PIN_CLKM</a> changes after awake, if the value of the parameter <em>clkrate</em> <b>is not</b> {0,6,7}.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>The <code>prep_clkchange()</code> function is MCU dependent and is responsible to bring the MCU to a state, where a clock change is allowed. After asserting <a class="el" href="grpIntroMCU.html#wirePinSleepTr">TRX_PIN_SLP_TR</a> = HIGH, the CLKM signal delivers 35 (refer to <a class="el" href="pgConst.html#tTR3">tTR3</a>) cycles before it is turned off (CLKM = LOW, see also <a class="el" href="grpStateSleep.html#secphy_wake_sleep">PHY_STATE_TRX_OFF__SLEEP</a>).</dd></dl>
<div align="center">
<img src="inline_mscgraph_23.png" alt="inline_mscgraph_23" border="0" usemap="#inline_mscgraph_23.map">
<map name="inline_mscgraph_23.map"><area href="grpIntroStates.html#stTrxOff" shape="rect" coords="430,26,470,39" alt="">
<area href="grpIntroStates.html#stSleep" shape="rect" coords="436,151,464,164" alt="">
<area href="pgConst.html#tTR2" shape="rect" coords="160,219,189,232" alt="">
<area href="grpIntroStates.html#stTrxOff" shape="rect" coords="430,301,470,314" alt="">
</map>
</div>
 <dl class="user" compact><dt><b>Code example</b></dt><dd><div class="fragment"><pre class="fragment">    <span class="comment">/* AT86RF212::TRX_OFF */</span>
    <a class="code" href="group__apiHalFuncBasic.html#g4a22a30602ea72effde4450ce80a6480" title="Write a value to a subregister.">trx_bit_write</a>(<a class="code" href="group__apiHalPHY212Sreg.html#g3517409068f4c36eedae73ed8ffead13">SR_CLKM_SHA_SEL</a>, 1);
    <a class="code" href="group__apiHalFuncBasic.html#g4a22a30602ea72effde4450ce80a6480" title="Write a value to a subregister.">trx_bit_write</a>(<a class="code" href="group__apiHalPHY212Sreg.html#gc108f260911d536daba845f79a0c7eff">SR_CLKM_CTRL</a>, clkrate);
    <a class="code" href="group__apiHalFuncBasic.html#g7ffbe4411fb6d28f884fd3da4c206893" title="Set the level of the SLP_TR pin.">trx_pinset_slptr</a>(1);
    <span class="comment">/* AT86RF212::SLEEP */</span>
    prep_clkchange();
    <a class="code" href="group__apiHalFuncBasic.html#g7ffbe4411fb6d28f884fd3da4c206893" title="Set the level of the SLP_TR pin.">trx_pinset_slptr</a>(0);
    delay(tTR2);
    <span class="comment">/* AT86RF212::TRX_OFF */</span>
</pre></div> </dd></dl>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 17 13:34:59 2009 for SWPM AT86RF212 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
